{"version":3,"sources":["webpack:///./src/assets/js/filters/pixelStretch.frag","webpack:///./src/assets/js/filters/PixelStretchFilter.js","webpack:///./src/assets/js/states/PixelStretch.js","webpack:///./src/assets/js/main.js"],"names":["pixelStretch","filters_PixelStretchFilter","pixi_es","[object Object]","boundary","verticalDir","super","this","undefined","uniforms","dimensions","Float32Array","filterManager","input","output","clear","filterFrame","width","height","applyFilter","value","states_PixelStretch","init","app","window","innerWidth","innerHeight","resolution","devicePixelRatio","antialias","preserveDrawingBuffer","document","body","appendChild","view","loader","add","Math","floor","random","load","resources","pic","pic1","texture","stage","addChild","stretchfilter","filters","gui","dat_gui_module","min","max","step","name","addEventListener","handleResize","bind","w","h","s","renderer","resize","h5","isPc","userAgentInfo","navigator","userAgent","Agents","Array","flag","v","length","indexOf","rootResize","wFsize","wWidth","documentElement","clientWidth","wHeight","clientHeight","getElementsByTagName","style","fontSize","eventInit","e","passive","preventDefault","cssInit","that","interval","timeout","end","lastInnerWidth","lastInnerHeight","noChangeCount","clearInterval","clearTimeout","setInterval","setTimeout","onload"],"mappings":"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","file":"assets/js/main.25b280c5a66fbf61e74d.js","sourcesContent":["export default \"// precision highp float;\\nvarying vec2 vTextureCoord;\\n\\nuniform sampler2D uSampler;\\n\\nuniform float boundary;\\nuniform bool verticalDir;\\n\\nuniform vec4 filterArea;\\nuniform vec2 dimensions;\\n//direction\\nuniform float sinDir;\\nuniform float cosDir;\\n\\n\\n\\nvec4 stretch(sampler2D tex, float boundary, bool verticalDir){\\n    vec4 color = texture2D(tex, vTextureCoord);\\n    vec2 p = vTextureCoord;\\n    float zero = 0.0;\\n    vec2 n = vec2(vTextureCoord.x, vTextureCoord.y);\\n    if(verticalDir){\\n        float areaY = boundary * dimensions.y / filterArea.y;\\n        if(areaY > zero){\\n            float b = areaY;\\n            if (p.y < b){\\n                n.y = n.y;\\n            }else{\\n                n.y = b;\\n            }\\n        }else{\\n            float b = -areaY;\\n            if (p.y > b){\\n                n.y = n.y;\\n            }else{\\n                n.y = b;\\n            }\\n        }\\n    }else{\\n        float areaX = boundary * dimensions.x / filterArea.x;\\n        if(areaX > zero){\\n            float b = areaX;\\n            if (p.x < b){\\n                n.x = n.x;\\n            }else{\\n                n.x = b;\\n            }\\n        }else{\\n            float b = -areaX;\\n            if (p.x > b){\\n                n.x = n.x;\\n            }else{\\n                n.x = b;\\n            }\\n        }\\n\\n    }\\n    color = texture2D(tex, n);\\n    return color;\\n}\\n\\nvoid main(void) {\\n    vec2 pixelCoord = vTextureCoord.xy * filterArea.xy;\\n    vec2 coord = pixelCoord / dimensions;\\n    vec4 color;\\n    color=stretch(uSampler, boundary, verticalDir);\\n\\n    gl_FragColor = color;\\n}\"","import { Filter, defaultVertex } from 'pixi.js';\n// import { Matrix, Point } from 'pixi.js/math';\n// import vertex from './pixelStretch.vert';\nimport fragment from './pixelStretch.frag';\n\nclass PixelStretchFilter extends Filter {\n    constructor(boundary, verticalDir) {\n        super(defaultVertex, fragment);\n\n        this.boundary = boundary || 0.0;\n        if(verticalDir === null || verticalDir === undefined){\n            this.verticalDir = false;\n        }else{\n            this.verticalDir = verticalDir;\n        }\n        \n        this.uniforms.dimensions = new Float32Array(2);\n    }\n    /**\n     * Override existing apply method in PIXI.Filter\n     * @private\n     */\n    apply(filterManager, input, output, clear) {\n        this.uniforms.dimensions[0] = input.filterFrame.width;\n        this.uniforms.dimensions[1] = input.filterFrame.height;\n        filterManager.applyFilter(this, input, output, clear);\n    }\n    /**\n     * The boundary of the stretch. -1 to 1\n     * Negative number, Negative direction. Positive number, Positive direction.\n     *\n     * @member {number}\n     * @default 0\n     */\n    set boundary(value) {\n        this.uniforms.boundary = value;\n    }\n    get boundary() {\n        return this.uniforms.boundary;\n    }\n    /**\n     * The direction of the stretch. `true` vertical, `false` horizontal\n     *\n     * @member {boolean}\n     * @default false\n     */\n    set verticalDir(value) {\n        this.uniforms.verticalDir = value;\n    }\n    get verticalDir() {\n        return this.uniforms.verticalDir;\n    }\n}\n\nexport default PixelStretchFilter;","import * as PIXI from 'pixi.js'\nimport PixelStretchFilter from '../filters/PixelStretchFilter.js'\nimport * as dat from 'dat.gui';\n\nclass PixelStretch {\n    constructor() {\n        this.init()\n    }\n    init() {\n        var app = new PIXI.Application({\n            width: window.innerWidth,\n            height: window.innerHeight,\n            resolution: window.devicePixelRatio,\n            antialias: true,\n            preserveDrawingBuffer: true,\n        });\n        this.app = app;\n        document.body.appendChild(app.view);\n        // PIXI.utils.clearTextureCache;\n        app.loader.add('pic1', `./assets/img/pic${Math.floor(Math.random()*5+1)}.jpg`)\n        app.loader.load(onLoaded.bind(this))\n\n        function onLoaded(loader, resources) {\n            this.pic = new PIXI.Sprite(resources.pic1.texture)\n            app.stage.addChild(this.pic)\n\n            // uniform float boundary;\n            // uniform float verticalDir;\n            var stretchfilter = new PixelStretchFilter(0, false)\n            app.stage.filters = [stretchfilter]\n\n            var gui = new dat.GUI();\n            gui.add(stretchfilter, 'boundary').min(-1).max(1).step(0.01);\n            gui.add(stretchfilter, 'verticalDir').name('verticalDir');\n\n            window.addEventListener('resize', this.handleResize.bind(this))\n            this.handleResize();\n\n            // var count = 0;\n            // app.ticker.add(function() {\n            // count += 0.01;\n            // stretchfilter.boundary = Math.abs(Math.sin(count))\n            // })\n        }\n\n    }\n\n    handleResize() {\n        var w = window.innerWidth;\n        var h = window.innerHeight;\n        var pic = this.pic;\n        var s = pic.width / pic.height;\n        this.app.renderer.resize(w, h);\n        if (s > w / h) {\n            pic.width = w;\n            pic.height = w / s;\n        } else {\n            pic.height = h;\n            pic.width = h * s;\n        }\n\n    }\n\n}\nexport default PixelStretch;","/**\n * Created by sanchez \n */\n'use strict';\n\n//check the environment\n// if (process.env.NODE_ENV !== 'production') {\n//     console.log('Looks like we are in development mode!');\n// }\n\n// import CSS\n// import animate_css from 'animate.css/animate.min.css';\nimport css from '../css/css.css';\n\nimport PixelStretch from './states/PixelStretch.js';\n\n\nwindow.h5 = {\n    isPc: function() {\n        var userAgentInfo = navigator.userAgent;\n        var Agents = new Array('Android', 'iPhone', 'SymbianOS', 'Windows Phone', 'iPad', 'iPod');\n        var flag = true;\n        for (var v = 0; v < Agents.length; v++) {\n            if (userAgentInfo.indexOf(Agents[v]) > 0) { flag = false; break; }\n        }\n        return flag;\n    },\n    rootResize: function() {\n        var wFsize;\n\n        //iphone6/6s/7/8 orientation=portrait screen.width=750px screen.height=1334px / WeChat window.innerWidth=750px window.innerHeight=1206px \n        var wWidth = document.documentElement.clientWidth || window.innerWidth;\n        var wHeight = document.documentElement.clientHeight || window.innerHeight;\n\n        if (wWidth > wHeight) {\n            wFsize = wHeight / 750 * 100;\n        } else {\n            wFsize = wWidth / 750 * 100;\n        }\n        document.getElementsByTagName('html')[0].style.fontSize = wFsize + 'px';\n    },\n    eventInit: function() {\n        var that = this;\n        document.addEventListener('touchstart', function(e) {}, { passive: false });\n        document.addEventListener('touchmove', function(e) {\n            e.preventDefault();\n        }, { passive: false });\n        return that;\n    },\n    cssInit: function() {\n        var that = this;\n        var noChangeCountToEnd = 100,\n            noEndTimeout = 1000;\n        that.rootResize();\n        window.addEventListener('onorientationchange' in window ? 'orientationchange' : 'resize', function() {\n            var interval,\n                timeout,\n                end,\n                lastInnerWidth,\n                lastInnerHeight,\n                noChangeCount;\n            end = function() {\n                //\"orientationchangeend\"\n                clearInterval(interval);\n                clearTimeout(timeout);\n                interval = null;\n                timeout = null;\n                that.rootResize();\n            };\n            interval = setInterval(function() {\n                if (window.innerWidth === lastInnerWidth && window.innerHeight === lastInnerHeight) {\n                    noChangeCount++;\n                    if (noChangeCount === noChangeCountToEnd) {\n                        //The interval resolved the issue first.\n                        end();\n                    }\n                } else {\n                    lastInnerWidth = window.innerWidth;\n                    lastInnerHeight = window.innerHeight;\n                    noChangeCount = 0;\n                }\n            });\n            timeout = setTimeout(function() {\n                //The timeout happened first.\n                end();\n            }, noEndTimeout);\n        });\n\n        return that;\n    },\n    init: function() {\n        var that = this;\n        that.cssInit().eventInit();\n    }\n};\nwindow.onload = function() {\n    window.h5.init();\n    var pixelstretch = new PixelStretch();\n    // pixelstretch.init();\n};\n\n//Stats JavaScript Performance Monitor\n\n//import Stats from 'stats.js';\n//showStats();\n// function showStats() {\n//     var stats = new Stats();\n//     stats.showPanel(0); // 0: fps, 1: ms, 2: mb, 3+: custom\n//     var fs = document.createElement('div');\n//     fs.style.position = 'absolute';\n//     fs.style.left = 0;\n//     fs.style.top = 0;\n//     fs.style.zIndex = 999;\n//     fs.appendChild(stats.domElement);\n//     document.body.appendChild(fs);\n\n//     function animate() {\n//         stats.begin();\n//         // monitored code goes here\n//         stats.end();\n//         requestAnimationFrame(animate);\n//     }\n//     requestAnimationFrame(animate);\n// }"],"sourceRoot":""}